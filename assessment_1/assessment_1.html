<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Student number: 23083053">

<title>Agent-Based Modelling Assessment 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="assessment_1_files/libs/clipboard/clipboard.min.js"></script>
<script src="assessment_1_files/libs/quarto-html/quarto.js"></script>
<script src="assessment_1_files/libs/quarto-html/popper.min.js"></script>
<script src="assessment_1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="assessment_1_files/libs/quarto-html/anchor.min.js"></script>
<link href="assessment_1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="assessment_1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="assessment_1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="assessment_1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="assessment_1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Agent-Based Modelling Assessment 1</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Student number: 23083053 </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="aim" class="level2">
<h2 class="anchored" data-anchor-id="aim">Aim</h2>
<p>This report aims to investigate the impact of various factors to the wealth distribution and the survival rate of turtles in the sugarscape model.</p>
<p>In this report, the following 2 models from the NetLogo Models Library are investigated and compared.</p>
<ul>
<li>Sugarscape 2 Constant Growback model <span class="citation" data-cites="li2009">(<a href="#ref-li2009" role="doc-biblioref">Li and Wilensky, 2009a</a>)</span></li>
<li>Sugarscape 3 Wealth Distribution <span class="citation" data-cites="li2009a">(<a href="#ref-li2009a" role="doc-biblioref">Li and Wilensky, 2009b</a>)</span></li>
</ul>
<p>The differences between the 2 models is that “Sugarscape 3” introduces the idea of ageing where turtles who have reached a certain age will die, and that dead turtles will be replaced by a new turtle placed in a random position on the field. The “Sugarscape 2” model can be interpreted as a representation of one generation of turtles, where “Sugarscape 3” models multiple generations.</p>
<p>Research question upon comparison of the 2 models is: is there a difference in the survival rate and the Gini index when considering the reproduction?</p>
<p>My hypothesis is that the wealth distribution among turtles will even out when considering reproduction. The inequality is due to the behaviour of turtles being ‘stuck’ to different areas with different amount of sugar, thus leading to the fixture of inequality where the ‘rich get richer’ thanks to the access to more productive patches. The reproduction has the function to redistribute the turtles after a certain amount of time, so more fluidness is expected to be introduced to the system.</p>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<p>We have modified the Sugarscape Models in the NetLogo Models Library <span class="citation" data-cites="li2009 li2009a">(<a href="#ref-li2009" role="doc-biblioref">Li and Wilensky, 2009a</a>, <a href="#ref-li2009a" role="doc-biblioref">2009b</a>)</span> enabling us to modify constants on the interface and have reporters present the performance of each model. We have modified the following parameters to observe the relationship between each varible and the performance of each model.</p>
<section id="changing-variables" class="level3">
<h3 class="anchored" data-anchor-id="changing-variables">Changing variables</h3>
<p>Using the BehaviorSpace function of NetLogo, we have simulated the performance for the following combinations of variables for both Sugarscape 2 and 3 models.. All variations of the model were repeated 20 times to acquire a distribution of the results.</p>
<table class="table">
<caption>The variables and the range considered in this report.</caption>
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Explanation</th>
<th>Range</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>initial_population</code></td>
<td>Initial population of turtles.</td>
<td>200, 400, 600, 800, 1000</td>
</tr>
<tr class="even">
<td><code>max-metabolism</code></td>
<td>Maximum metabolism of turtles. Metabolism for each turtle is assigned randomly between 1 and this variable.</td>
<td>2, 4, 6, 8, 10</td>
</tr>
<tr class="odd">
<td><code>max-vision</code></td>
<td>Maximum vision of turtles. Vision for each turtle is assigned randomly between 1 and this variable.</td>
<td>2, 4, 6, 8, 10</td>
</tr>
<tr class="even">
<td><code>max-max-age</code></td>
<td>The maximum number for the maximum age (the age of death) of turtles. Maximum age for each turtles is assigned randomly between 60% and 100% of this variable.</td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="reporters-of-performance" class="level3">
<h3 class="anchored" data-anchor-id="reporters-of-performance">Reporters of performance</h3>
<p>For each model we have created, we have chosen the following indeces to measure the performance of each model.</p>
<ul>
<li>the survival rate of turtles, which will be defined as:
<ul>
<li>the percentage of turtles alive at the natural state to the initial population (Sugarscape 2)</li>
<li>the percentage of turtles who died because of age (not by starvation) to the total deaths (Sugarscape 3)</li>
</ul></li>
<li>the Gini Index (ratio of area under the Lorenz curve compared to perfect equality: cumulative proportion of population compared to the cumulative proportion of wealth <span class="citation" data-cites="oecd2015">(<a href="#ref-oecd2015" role="doc-biblioref">OECD, 2015</a>)</span>)</li>
</ul>
<p>The following were observed to supplement the above parameters to identify the state of the models.</p>
<ul>
<li>the number of turtles at the natural state</li>
<li>the mean vision of alive turtles</li>
<li>the mean metabolism of alive turtles</li>
</ul>
</section>
<section id="time-of-observations" class="level3">
<h3 class="anchored" data-anchor-id="time-of-observations">Time of Observations</h3>
<p>We observed these parameters at the natural state. We have defined this as follows:</p>
<ul>
<li>100 ticks after the last death (Sugarscape 2)</li>
<li>observation window of 2 to 5 maximum lifespan lengths after start (Sugarscape 3)</li>
</ul>
</section>
<section id="comparison-between-models" class="level3">
<h3 class="anchored" data-anchor-id="comparison-between-models">Comparison between models</h3>
<p>When comparing models, all parameters must be aligned to observe the difference in behaviour. The population is compared using the natural state after the inital drop in population occured for the Sugarscape 2 model, in order to compare between natural states of each model.</p>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<section id="survival-rate" class="level3">
<h3 class="anchored" data-anchor-id="survival-rate">Survival Rate</h3>
<p>The 2 models were compared on the basis of alive turtles at the natural state. Sugarscape 2 model will have less turtles than the initial state, while Sugarscape 3 model will have the same number of turtles as the start.</p>
<p>The observed survival rate for each of the models are shown as follows.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image/survival_rate_combined.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Comparison of survival rate of the 2 models. Higher survival rates are achieved by lower metabolism, higher vision, and lower population. There seems to be no significant difference in the survival rate between the two models.</figcaption>
</figure>
</div>
</section>
<section id="gini-index" class="level3">
<h3 class="anchored" data-anchor-id="gini-index">Gini Index</h3>
<p>The Gini Index for each simulation is plotted as follows:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image/gini_index_combined.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Comparison of the Gini Index of the 2 models. Overall, the Sugarscape 3 model tends to have a higher Gini Index compared to the Sugarscape 2 model.</figcaption>
</figure>
</div>
<p>The Sugarscape 3 model has a higher Gini Index overall, and is less affected by the population of turtles. On the other hand, Sugarscape 2 model has a lower Gini Index, but is highly affected by the population, with an interesting N-shaped pattern that can be observed. This pattern was most dinstinctive in conditions with high vision and moderate metabolism range, as shown in the figure below.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image/s2_mvp_gini_filtered.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Gini Index for Sugascape 2 model with <code>max-vision</code> == 10 and <code>max-metabolism</code> = 4.</figcaption>
</figure>
</div>
</section>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<section id="gini-index-1" class="level3">
<h3 class="anchored" data-anchor-id="gini-index-1">Gini Index</h3>
<section id="relationship-with-population" class="level4">
<h4 class="anchored" data-anchor-id="relationship-with-population">Relationship with Population</h4>
<p>The results have shown an N-shaped pattern for the relationship between the population and the Gini Index at the natural state. The inequality will increase corresponding to population, but at a certain point will start to decrease, and finally increases again. To identify the reason behind this phenomenon, we analysed the wealth distribution for each model. A snapshot of the natural state and the wealth distribution for a model with different initial population is shown below. The net wealth gained per tick is the amount of sugar for each turtle divided by the ticks passed. This shows the net sugar gain each turtle has achieved per tick, or the difference between the collected sugar and metabolism.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image/wealth_dist_graphs.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Snapshot of natural state (left) and the histogram of wealth distribution for different initial population (<code>max-vision</code> == 10 and <code>max-metabolism</code> = 4). The range was divided into 10 bins to create histogram, and was plotted according to the net wealth gained per tick.</figcaption>
</figure>
</div>
<p>We can observe the wealth distribution is separated into distinct groups for all 4 simulations. This may be due to the metabolism having integer values, and the available sugar is steady once the model reaches its natural state.</p>
<p>The model with initial population of 100 has most of the turtles clustered in the high growth areas indicated by darker yellow, allowing for more sugar for the majority of the turtles. The separation of groups is less obvious compared to the other models.</p>
<p>The second model has 3 distinct groups, clustered around 0, 1 and 2. This can be explained as follows:</p>
<ul>
<li>The turtles have a steady income of 3, 2 or 1 depending on the area.</li>
<li>Turtles no longer have access to a steady income of 4, observed in the first model.</li>
</ul>
<p>The third model shows a similar pattern with the second model, with a slightly lower maximum net wealth gained per tick value and a significantly smaller population of the group clustered around 0. This implies each turtle has a slightly smaller income compared to the previous model, and the slight decrease had a fatal impact on the ‘poorest’ group, leading to a decrease in number. The improvement in the Gini Index was a result of this starvation, not a result of equal distribution of sugar.</p>
<p>The final model sees a shift of the groups to the left, and the groups spreading out. The competition has made it difficult to gain a steady (integer) amount of income throughout the simulation, and lead to a decline in the average income earned every tick. The Gini Index has increased because of the relationship between the two groups; the same absolute difference now has a different ratio, making the poorer group having less overall share of the total wealth.</p>
</section>
<section id="considering-reproduction" class="level4">
<h4 class="anchored" data-anchor-id="considering-reproduction">Considering Reproduction</h4>
<p>An interesting pattern was observed for inequality, where by introducing the reproduction scheme the Gini Index increased, indicating higher inequality. This was a counterintuitive result, as the ‘resetting’ of wealth by each generation seems to lead to even out the distribution of wealth.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image/s3_wealth_skewed.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Distribution of wealth in a Sugarscape 3 model at the natural state. <code>max-vision</code> = 6, <code>max-metabolism</code> = 4, <code>max-max-age</code> = 100</figcaption>
</figure>
</div>
<p>In the simulation, the wealth distribution for the Sugarscape 3 model shows a negatively skewed distribution as shown above. As a result of constantly replacing dead turtles with newborn ones, turtles that are spawn in areas where it is impossible to survive in the Sugarscape 3 model are constantly supplied, leading to a steady amount of the poor population which will starve to death in the near future.</p>
</section>
</section>
<section id="survival-rate-1" class="level3">
<h3 class="anchored" data-anchor-id="survival-rate-1">Survival Rate</h3>
<p>Some patterns can be observed for the survival rate. The survival rate for the 2 models share a similar pattern when the final population is similar. This result ensures our definition of survival rates are decent. The trend is showing a steep drop at low population, followed by a relatively flat segment where the survival rate stays unchanged in accordance to population change.</p>
<p>This can also be explained through the wealth distribution we have observed in the above section. The initial drop is explained by the difference between the second and third model, where the ‘poorest’ group can no longer survive, leading to a drop in the survival rate. The relatively flat area that follows is illustrated between the third and the fourth model, where the average income decreases but no significant population groups starve.</p>
<p>This can be supported by the relationship between the survival rate and the Gini Index shown below.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="image/s2_mvp_gini_survival.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">The relationship between the survival rate of turtles and the Gini Index for the Sugarscape 2 model.</figcaption>
</figure>
</div>
<p>The ‘N-shape’ of this graph consists of two patterns observed:</p>
<ol type="1">
<li>survival rate does not change significantly while the Gini Index increases</li>
<li>the survival rate and the Gini Index both drop</li>
</ol>
<p>The former can appear as a result of the ‘left shift’ of the wealth distribution histogram, while the latter may be caused by the poorest group forced into starvation.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>We have observed the impact of population and ability of turtles on the wealth distribution and the survival rate of the model. The survival rate and the Gini Index are both essential parameters when measuring the equality of wealth distribution. Our models have revealed that an improvement in the Gini Index (which only considers the surviving population) may be a result of the group with the least wealth starving to death, which is clearly not an ideal state. Further analysis is required to potentially identify a method that is capable of handling both survival rate and the inequality of the surviving. Reproduction rules also have great impact on the final output. We have considered a replacement in random locations, but there is room for extended research considering the influence of the parent generation to the characteristics of the newborn. This will enable us to consider the effect of real-life phenomena such as education levels and inheritance of wealth.</p>
</section>
<section id="references" class="level2 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" role="list">
<div id="ref-li2009" class="csl-entry" role="listitem">
Li, J. and Wilensky, U. (2009a) <span>“<span>NetLogo Models Library</span>: <span>Sugarscape</span> 2 <span>Constant Growback</span>.”</span> <span>Evanston, IL.</span>: Center for Connected Learning and Computer-Based Modeling, Northwestern University.
</div>
<div id="ref-li2009a" class="csl-entry" role="listitem">
Li, J. and Wilensky, U. (2009b) <span>“<span>NetLogo Models Library</span>: <span>Sugarscape</span> 3 <span>Wealth Distribution</span>.”</span> <span>Evanston, IL.</span>: Center for Connected Learning and Computer-Based Modeling, Northwestern University.
</div>
<div id="ref-oecd2015" class="csl-entry" role="listitem">
OECD (2015) <span>“Inequality - <span>Income</span> inequality - <span>OECD Data</span>,”</span> <em>theOECD</em>. http://data.oecd.org/inequality/income-inequality.htm.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>